# ---------------------------------------------------------------------------
# 1_DensifyArcs.py
# Created on: Wed Mar 12 2008 04:21:13 PM
#   (generated by ArcGIS/ModelBuilder)
# Product: Bobby Sas, Student, MS Applied Geosciences, San Francisco State University
# Code: Jerry Davis and Barry Nickel, Institute for Geographic Information Science, San Francisco State University
#
# General Description: 1_DensifyArcs.py is step 1 of 4. Densify polylines before converting to points.
# ---------------------------------------------------------------------------

# Import system modules
import sys, string, os, arcgisscripting

# Create the Geoprocessor object
gp = arcgisscripting.create()

# Load required toolboxes...
gp.AddToolbox("C:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Data Management Tools.tbx")

inputLines = sys.argv[1]
distance = sys.argv[2]
tolerance2 = sys.argv[3]
gp.SetParameterAsText(3, inputLines)

# Local variables...
roadsegment__2_ = "roadsegment"
roadsegment = "roadsegment"

# Process: Calculate Field...
VBAstart = "Dim pGeometry As IGeometry\\nDim pPolycurve As IPolycurve\\nDim dTol1 as Double\\nDim dTol2 as Double\\nDim pTopOp As ITopologicalOperator\\n\\ndTol1 = "
VBAmid = "\\ndTol2 = "
VBAend = "\\n\\nIf (Not IsNull([Shape])) Then\\n  Set pGeometry = [Shape]\\n  If (Not pGeometry.IsEmpty) Then\\n    If (pGeometry.GeometryType = esriGeometryPolygon) Or (pGeometry.GeometryType = esriGeometryPolyline) Then\\n      Set pPolycurve = pGeometry\\n      pPolycurve.Densify  dTol1, dTol2\\n    End If\\n  End If\\nEnd If"
VBAstring = VBAstart + distance + VBAmid + tolerance2 + VBAend

gp.CalculateField_management(inputLines, "Shape", "pGeometry", "VB", VBAstring)


